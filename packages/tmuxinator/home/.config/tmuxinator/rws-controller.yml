# rws-controller.yml
<% 
  require "#{File.dirname(path)}/tmuxinator_project.rb"
  project = TmuxinatorProject.new(path: path).setup # path is a value from Tmuxinator

  # Clone the pcs-terraform-modules to the pcs dir
  pcs_modules_dir = project.projects_dir.join('pcs/terraform-modules')
  unless pcs_modules_dir.join('.git').exist?
    repo = "#{project.remote_prefix}/pcs-terraform-modules.git"
    require 'git'
    Git.clone(repo, pcs_modules_dir)
  end

  modules_dir = project.root.join('terraform/modules')
  project.symlink(from: modules_dir, to: pcs_modules_dir)
%>

name: <%= project.name %>
root: <%= project.root %>

# Global settings
attach: true
tmux_command: tmux

windows:
  - ansible:
      root: <%= project.subdir('ansible') %>
      layout: <%= project.layout(:claude) %>
      panes:
        - claude
        - tree
        - nvim .
  - unifi:
      root: <%= project.projects_dir.join('pcs/infra/roles/unifi') %>
      layout: <%= project.layout(:even_horizontal) %>
      panes:
        - tree
        - nvim .
  - proxmox:
      root: <%= project.projects_dir.join('pcs/infra/roles/proxmox') %>
      layout: <%= project.layout(:even_horizontal) %>
      panes:
        - tree
        - nvim .
  - netboot:
      root: <%= project.projects_dir.join('pcs/infra/roles/netbootxyz') %>
      layout: <%= project.layout(:even_horizontal) %>
      panes:
        - tree
        - nvim .
  - terraform:
      root: <%= project.subdir('terraform') %>
      layout: <%= project.layout(:even_horizontal) %>
      panes:
        - tree
        - nvim .
